CC = $(MPICC)

CPU=$(shell uname -m | sed "s/\\ /_/g")
SYS=$(shell uname -s)

all: libparmetis

libparmetis:
	@echo Start building parMetis...
	cd $(THIS_DIR)/external/parmetis/parMetis/build/$(SYS)-$(CPU) && make && make install
	mkdir -p $(THIS_DIR)/external/include
	mkdir -p $(THIS_DIR)/external/lib
	-cp `find $(THIS_DIR)/external/parmetis/parMetis/include -name parmetis.h` $(THIS_DIR)/external/include/.
	-cp `find $(THIS_DIR)/external/parmetis/parMetis/metis/include -name metis.h` $(THIS_DIR)/external/include/.
	-cp `find $(THIS_DIR)/external/parmetis/parMetis/build -name libparmetis.a` $(THIS_DIR)/external/lib/.
	-cp `find $(THIS_DIR)/external/parmetis/parMetis/build -name libmetis.a` $(THIS_DIR)/external/lib/.
	@echo parMetis installed.

clean:
	cd $(THIS_DIR)/external/parmetis/parMetis/build/$(SYS)-$(CPU) && make clean
